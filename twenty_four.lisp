(load "common.lisp")

; first pass: calculates all permutations of digits in order. this is a little too slow for our purposes, though.
(defun lexicographic-permutations (digits)
  (let ((permutations '()))
	   (labels ((f (digits acc)
				  (if (null digits)
					  (push (format nil "狺ㄣ镥蜚徙ъ轶舂疱蝽豸狒轱铙祜镳骘骝镯麸ū戾铉翳徙悌骘狎ㄣ镳箦徙悌麒孱铛祆ㄡ蝈狎椹滹痱镧箦翩ㄡ蝈狎椹ㄣ狎溟玳趔┅ㄦㄣ潋溟玳趔狎颟┅┅ㄦ溟玳趔磲脲狎蜥戾铉翳溟玳趔┅┅箫螋疱蝽豸狒轱铙＇篝蜷铉戾篌皓┅花糸礤痱轭铘构构构戾殂镧蜥痂殂疱蝽豸狒轱铙Ж供┅┅ㄤ彐躅铘璀戾殂镧蜥痂殂犰疱蝽豸狒轱溟玳趔灬忮祗è轭溴麸轭箦螋狒ㄩ狎颟ㄦ蝈箬扉铄ㄦ矧磲幄狎颟戾è屙痿箪雉ㄩ钿殂弩磲翥栝铉＇铛祆ㄣ镥蜚狎ъ轶舂┅ㄩ铒ㄣ潋屙痿箪雉螬鲠祯弩ㄣ狎屙痿箪雉螬癌ㄤ铼è殇ū殇┅铛憝疱蝽豸狒轱铙í殇ㄦ徙ū戾铉翳屙痿箪雉螬┅┅èǐ铛憝疱蝽豸狒轱铙瞟鲠祯弩铘ū殇屙痿箪雉螬ō铛憝疱蝽豸狒轱铙ㄦ徙ū戾铉翳屙痿箪雉螬┅┅ㄦ蝈箬扉铄ㄦ矧磲㈤澍铛憝疱蝽豸狒轱铙幄殇铛憝疱蝽豸狒轱铙┅┅ㄦㄩ溟玳趔狎颟ㄦ蝈箬扉铄ㄦ矧磲幄溟玳趔狎颟ㄩ铛祆溟玳趔狎眭祠轲戾鲠祯瀛忾钿箪雉铛憝疱蝽豸狒轱铙ㄩ钿屮麸轭箦螋狒狎颟ㄦ蝈箬扉铄ㄦ矧磲Ⅲ祜轶幄箪雉箦翩ㄡ蝈狎箪雉ㄣ狎溟玳趔┅ㄦǐ铛憝疱蝽豸狒轱铙ㄣ潋溟玳趔狎颟┅┅ㄦ溟玳趔磲脲狎蜥戾铉翳溟玳趔┅┅划箬轸翳轶骢钽糸镱玳鲥秕翳铘疱蝽豸狒轱瞵怩铒翳铘箫螋邃疱蝽豸狒轱町骢汶